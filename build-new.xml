<project name="gdx" default="all" basedir=".">
	<description>libgdx distribution build file</description>
	<property environment="env" />
	
	<!-- define distribution/output directory -->
	<property name="distDir" value="${basedir}/dist"/>
	<property name="build-natives" value="false"/>
	
	<!-- clean distribution/output directory -->
	<target name="clean">
		<delete dir="${distDir}"/>
	</target>
	
	<!-- build the core of the library plus all backends -->
	<!-- gdx jnigen -->
	<target name="gdx-jnigen">
		<ant antfile="../../build-template.xml" dir="extensions/gdx-jnigen">
			<property name="jar" value="gdx-jnigen"/>
		</ant>
	</target>
	
	<!-- gdx core -->
	<target name="gdx-core" depends="gdx-jnigen">
		<path id="classpath">
			<pathelement location="${distDir}/extensions/gdx-jnigen.jar"/>
		</path>
		<ant antfile="../build-template.xml" dir="gdx">
			<property name="jar" value="gdx"/>
		</ant>
	</target>
	
	<!-- gdx openal, for all desktop backends -->
	<target name="gdx-openal" depends="gdx-core">
		<path id="classpath">
			<pathelement location="${distDir}/gdx.jar"/>
		</path>
		<ant antfile="../../build-template.xml" dir="backends/gdx-openal">
			<property name="jar" value="gdx-openal"/>
			<reference refid="classpath"/>
		</ant>
	</target>
	
	<!-- gdx jogl backend -->
	<target name="gdx-backend-jogl" depends="gdx-core,gdx-openal">
		<path id="classpath">
			<pathelement location="${distDir}/gdx.jar"/>
			<pathelement location="${distDir}/gdx-openal.jar"/>
		</path>
		<zipfileset id="jarfiles" src="${distDir}/gdx-openal.jar"/>
		<ant antfile="../../build-template.xml" dir="backends/gdx-backend-jogl">
			<property name="jar" value="gdx-backend-jogl"/>
			<reference refid="classpath"/>
			<reference refid="jarfiles"/>
		</ant>
	</target>
	
	<!-- gdx lwjgl backend -->
	<target name="gdx-backend-lwjgl" depends="gdx-core,gdx-openal">
		<path id="classpath">
			<pathelement location="${distDir}/gdx.jar"/>
			<pathelement location="${distDir}/gdx-openal.jar"/>
		</path>
		<zipfileset id="jarfiles" src="${distDir}/gdx-openal.jar"/>
		<ant antfile="../../build-template.xml" dir="backends/gdx-backend-lwjgl">
			<property name="jar" value="gdx-backend-lwjgl"/>
			<reference refid="classpath"/>
			<reference refid="jarfiles"/>
		</ant>
	</target>
	
	<!-- gdx android backend -->
	<target name="gdx-backend-android" depends="gdx-core">
		<path id="classpath">
			<pathelement location="${distDir}/gdx.jar"/>
		</path>
		<ant antfile="../../build-template.xml" dir="backends/gdx-backend-android">
			<property name="jar" value="gdx-backend-android"/>
			<reference refid="classpath"/>
		</ant>
	</target>
	
	<!-- build the extensions -->
	<!-- gdx tools -->
	<target name="gdx-tools" depends="gdx-core,gdx-backend-lwjgl">
		<path id="classpath">
			<pathelement location="${distDir}/gdx.jar"/>
			<pathelement location="${distDir}/gdx-backend-lwjgl.jar"/>
		</path>
		<ant antfile="../../build-template.xml" dir="extensions/gdx-tools">
			<property name="distDir" value="${distDir}/extensions"/>
			<property name="jar" value="gdx-tools"/>
			<reference refid="classpath"/>
		</ant>
	</target>
	
	<!-- gdx tiled processor -->
	<target name="gdx-tiled-preprocessor" depends="gdx-core">
		<path id="classpath">
			<pathelement location="${distDir}/gdx.jar"/>
			<pathelement location="${distDir}/gdx-backend-lwjgl.jar"/>
		</path>
		<ant antfile="../../build-template.xml" dir="extensions/gdx-tiled-preprocessor">
			<property name="distDir" value="${distDir}/extensions"/>
			<property name="jar" value="gdx-tiled-preprocessor"/>
			<reference refid="classpath"/>
		</ant>
	</target>
	
	<!-- gdx stb truetype -->
	<target name="gdx-stb-truetype" depends="gdx-core">
		<path id="classpath">
			<pathelement location="${distDir}/gdx.jar"/>
			<pathelement location="${distDir}/gdx-jnigen.jar"/>
		</path>
		<ant antfile="../../build-template.xml" dir="extensions/gdx-stb-truetype">
			<property name="distDir" value="${distDir}/extensions"/>
			<property name="jar" value="gdx-stb-truetype"/>
			<reference refid="classpath"/>
		</ant>
	</target>
	
	<!-- gdx audio -->
	<target name="gdx-audio" depends="gdx-core">
		<path id="classpath">
			<pathelement location="${distDir}/gdx.jar"/>
			<pathelement location="${distDir}/gdx-jnigen.jar"/>
		</path>
		<ant antfile="../../build-template.xml" dir="extensions/gdx-audio">
			<property name="distDir" value="${distDir}/extensions"/>
			<property name="jar" value="gdx-audio"/>
			<reference refid="classpath"/>
		</ant>
	</target>
	
	<!-- gdx bullet -->
	<target name="gdx-bullet" depends="gdx-core">
		<path id="classpath">
			<pathelement location="${distDir}/gdx.jar"/>
			<pathelement location="${distDir}/gdx-jnigen.jar"/>
		</path>
		<ant antfile="../../build-template.xml" dir="extensions/gdx-bullet">
			<property name="distDir" value="${distDir}/extensions/gdx-bullet"/>
			<property name="jar" value="gdx-bullet"/>
			<reference refid="classpath"/>
		</ant>
	</target>
	
	
	<target name="all" depends="clean,gdx-core,gdx-openal,gdx-backend-jogl,gdx-backend-lwjgl,gdx-backend-android,gdx-tools,gdx-tiled-preprocessor,gdx-stb-truetype,gdx-audio">
		<!-- copy distribution files (licences etc.) -->
		<copy tofile="${dist}/README" file="gdx/dist/README"/>
		<copy tofile="${dist}/LICENSE" file="gdx/dist/LICENSE"/>
		<copy tofile="${dist}/CC-LICENSE" file="gdx/dist/CC-LICENSE"/>
		<copy tofile="${dist}/AUTHORS" file="gdx/dist/AUTHORS"/>
		<copy tofile="${dist}/CONTRIBUTORS" file="gdx/dist/CONTRIBUTORS"/>
	</target>
</project>